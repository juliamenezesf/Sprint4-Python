Sprint 4 â€” CRUD Python + Oracle + API Flask 

Integrantes:
JÃºlia Menezes - RM565568
Pedro Costa - RM559932

Este projeto entrega um CRUD completo integrado ao Oracle, exposto por API Flask, consumido pelo front React (Vite + TS) e com console (menus/submenus) + exportaÃ§Ã£o JSON + API pÃºblica.

ğŸ“ Estrutura
.
â”œâ”€ app/
â”‚  â”œâ”€ database_oracle.py   # CRUD + conexÃ£o Oracle (SQLAlchemy + oracledb)
â”‚  â”œâ”€ faq_api.py           # API Flask (endpoints /api/faqs)
â”‚  â”œâ”€ console_faq.py       # Console com menus: CRUD + export JSON + API pÃºblica
â”‚  â”œâ”€ external_api.py      # Cliente da API pÃºblica (Advice Slip)
â”‚  â””â”€ __init__.py
â”œâ”€ frontend/               # Seu front React + Vite + TS
â”œâ”€ sql/
â”‚  â”œâ”€ 01_create_faqs.sql   # script de criaÃ§Ã£o da tabela
â”‚  â””â”€ 02_seed_faqs.sql     # dados de exemplo (opcional)
â”œâ”€ requirements.txt
â”œâ”€ PASSO_A_PASSO_AVALIACAO.pdf
â””â”€ README.md

âœ… Requisitos cobertos

[10 pts] Menus/submenus CRUD: python -m app.console_faq

[30 pts] CRUD + export JSON: inserir, listar, atualizar, remover + faqs_export.json

[20 pts] API pÃºblica: â€œConselho do diaâ€ (Advice Slip) salvo como FAQ


ğŸ”§ PrÃ©-requisitos

Python 3.11 (recomendado no Windows para instalar oracledb sem compilar)

Node 18+ (front)

Acesso a um Oracle (SQL Developer/Instant Client)

ğŸ—„ï¸ Banco de Dados (Oracle)

Execute no seu schema:

-- sql/01_create_faqs.sql
CREATE TABLE FAQS (
  ID        NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  PERGUNTA  VARCHAR2(500)  NOT NULL,
  RESPOSTA  VARCHAR2(2000) NOT NULL
);

-- (opcional) sql/02_seed_faqs.sql
INSERT INTO FAQS (PERGUNTA, RESPOSTA)
VALUES ('Como marcar consulta?', 'Acesse "Como Acessar" e siga o passo a passo do Portal do Paciente.');
INSERT INTO FAQS (PERGUNTA, RESPOSTA)
VALUES ('Preciso de cadastro?', 'Sim. Cadastre uma senha com CPF do paciente e um contato vÃ¡lido.');
COMMIT;


Se nÃ£o suportar IDENTITY, adapte com SEQUENCE + TRIGGER.

ğŸ§  Back-end (Flask + SQLAlchemy)
1) Ambiente
python -m venv .venv
# PowerShell:
Set-ExecutionPolicy -Scope Process -ExecutionPolicy Bypass
.\.venv\Scripts\Activate.ps1

python -m pip install --upgrade pip
pip install -r requirements.txt

2) ConfiguraÃ§Ã£o

Crie .env (ou defina no terminal):

DATABASE_URL=oracle+oracledb://SEU_USUARIO:SUA_SENHA@HOST:1521/ORCL
# ou com service name:
# DATABASE_URL=oracle+oracledb://SEU_USUARIO:SUA_SENHA@HOST:1521/?service_name=NOME


Senhas com @ # / : etc. precisam de URL-encode (@â†’%40, #â†’%23â€¦).

3) Rodar a API
python -m app.faq_api
# http://127.0.0.1:5000/api/faqs

4) Endpoints

GET /api/faqs?q= â†’ lista (filtro opcional)

POST /api/faqs â†’ { pergunta, resposta }

PUT /api/faqs â†’ { id, pergunta?, resposta? }

DELETE /api/faqs/:id

ğŸ–¥ï¸ Console (menus/submenus + export JSON + API pÃºblica)
python -m app.console_faq


Menu:

1 Inserir Â· 2 Listar/Buscar Â· 3 Atualizar

4 Remover Â· 5 Exportar JSON Â· 6 Importar â€œConselho do diaâ€ (API pÃºblica)

O export gera faqs_export.json na raiz.


ğŸ§ª Testes rÃ¡pidos (PowerShell)
# criar
Invoke-RestMethod -Uri "http://127.0.0.1:5000/api/faqs" -Method POST `
  -ContentType "application/json; charset=utf-8" `
  -Body (@{pergunta="App Ã© gratuito?"; resposta="Sim, versÃ£o bÃ¡sica."} | ConvertTo-Json -Compress)

# listar
Invoke-RestMethod "http://127.0.0.1:5000/api/faqs"

# excluir (ajuste id)
Invoke-RestMethod -Uri "http://127.0.0.1:5000/api/faqs/1" -Method DELETE

ğŸ› ï¸ SoluÃ§Ã£o de problemas

oracledb falhando no Windows: use Python 3.11 (tem wheel pronto).

CORS no front: verifique CORS(app, origins=["http://localhost:5173","http://127.0.0.1:5173"]).

Not Found em /: a API sÃ³ responde em /api/faqs (raiz nÃ£o tem rota).

before_first_request: removido no Flask 3 â€” usamos db.init_db() no carregamento.
